<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>3 - External Pentest Playbook |</title>
<meta name="description" content="The full life cycle of an External Pentest: ROE, Osint, Attacking Login Portals, Report, Client Debriefs and More ">


  <meta name="author" content="Nullified">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="3 - External Pentest Playbook">
<meta property="og:url" content="http://localhost:4000/notes/pnpt/pentestexternal/">


  <meta property="og:description" content="The full life cycle of an External Pentest: ROE, Osint, Attacking Login Portals, Report, Client Debriefs and More ">



  <meta property="og:image" content="http://localhost:4000/assets/images/main/header2.jpg">





  <meta property="article:published_time" content="2023-11-26T00:00:00+06:00">





  

  


<link rel="canonical" href="http://localhost:4000/notes/pnpt/pentestexternal/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "john",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/jpeg" sizes="32x32" href="/assets/images/main/fav-32x32.jpeg">
<link rel="icon" type="image/jpeg" sizes="16x16" href="/assets/images/main/fav-16x16.jpeg">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/main/kaizen.png" alt=""></a>
        
        <a class="site-title" href="/">
          
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/menu">Menu</a>
            </li><li class="masthead__menu-item">
              <a href="/about">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
  
    

    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/assets/images/main/header2.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          3 - External Pentest Playbook

        
      </h1>
      
        <p class="page__lead">Testing the Security from an outside perspective.
</p>
      
      
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  7 minute read

</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Posts</span>
        

        
        <ul>
          
            <li><a href="/insights/roadmap/">- How to become a Pentester (2024)</a></li>
          
            <li><a href="/awareness/awarenessdoc/">- Security Awareness</a></li>
          
            <li><a href="/c2/sliverbasics/">- Sliver C2 Basics</a></li>
          
            <li><a href="">────────────────</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Notes</span>
        

        
        <ul>
          
            <li><a href="/notes/ejpt/">eJPT</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/ecppt/">eCPPTv2</a></li>
          
            <li><a href="/notes/ecppt/systemsecurity/">- System Security</a></li>
          
            <li><a href="/notes/ecppt/networksecurity/">- Network Security</a></li>
          
            <li><a href="/notes/ecppt/powershell/">- Powershell</a></li>
          
            <li><a href="/notes/ecppt/linux/">- Linux Security</a></li>
          
            <li><a href="/notes/ecppt/webapp/">- Web App Security</a></li>
          
            <li><a href="/notes/ecppt/wifi/">- Wi-Fi Pentest</a></li>
          
            <li><a href="/notes/ecppt/ruby/">- Metasploit & Ruby</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/pnpt/">PNPT</a></li>
          
            <li><a href="/notes/pnpt/peh/">- Practical Ethical Hacker</a></li>
          
            <li><a href="/notes/pnpt/osint/">- OSINT</a></li>
          
            <li><a href="/notes/pnpt/pentestexternal/" class="active">- External Pentest Playbook</a></li>
          
            <li><a href="/notes/pnpt/linuxprivesc/">- Linux Privesc</a></li>
          
            <li><a href="/notes/pnpt/winprivesc/">- Windows Privesc</a></li>
          
            <li><a href="/notes/pnpt/wpivoting/">- Movement, Pivoting and Persistence</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/eewptx/">eWPTXv2</a></li>
          
            <li><a href="/notes/ewptx/encoding/">- Encoding & Filtering</a></li>
          
            <li><a href="/notes/ewptx/evasionbasics/">- Evasion Basics</a></li>
          
            <li><a href="/notes/ewptx/xss/">- Cross-site scripting (XSS)</a></li>
          
            <li><a href="/notes/ewptx/xssfilter/">- XSS Filter Evasion</a></li>
          
            <li><a href="/notes/ewptx/csrf/">- Cross-site request forgery (CSRF)</a></li>
          
            <li><a href="/notes/ewptx/html5/">- HTML5</a></li>
          
            <li><a href="/notes/ewptx/sqli/">- SQL Injection</a></li>
          
            <li><a href="/notes/ewptx/sqlievasion/">- SQLI Filter Evasion</a></li>
          
            <li><a href="/notes/ewptx/xmlattacks/">- XML Attacks</a></li>
          
            <li><a href="/notes/ewptx/zattackingserialization/">- Attacking Serialization</a></li>
          
            <li><a href="/notes/ewptx/serverside/">- Server Side Attacks</a></li>
          
            <li><a href="/notes/ewptx/crypto/">- Attacking Crypto</a></li>
          
            <li><a href="/notes/ewptx/authenticationsso/">- Authentication & SSO</a></li>
          
            <li><a href="/notes/ewptx/apiscloud/">- APIs & Cloud Apps</a></li>
          
            <li><a href="/notes/ewptx/ldap/">- Attacking LDAP</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="">Active Directory Exploitation</a></li>
          
            <li><a href="/notes/adx/powershell/">- Powershell</a></li>
          
            <li><a href="/notes/adx/bloodhound/">- Bloodhound</a></li>
          
            <li><a href="/notes/adx/privesc/">- Win Privesc</a></li>
          
            <li><a href="/notes/adx/zlateralmov/">- Lateral Movement</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/crtp/">CRTP</a></li>
          
            <li><a href="/notes/crtp/enum/">- AD Enumeration</a></li>
          
            <li><a href="/notes/crtp/winprivesc/">- Local Privesc</a></li>
          
            <li><a href="/notes/crtp/latmov/">- Lateral Movement</a></li>
          
            <li><a href="/notes/crtp/offdotnet/">- Offensive .NET</a></li>
          
            <li><a href="/notes/crtp/domdom/">- AD Persistence</a></li>
          
            <li><a href="/notes/crtp/domprivesc/">- AD Privesc</a></li>
          
            <li><a href="/notes/crtp/defense/">- AD Defense</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/crte/">CRTE</a></li>
          
            <li><a href="/notes/crte/latmov/">- Lateral Movement</a></li>
          
            <li><a href="/notes/crte/adprivesc/">- AD Privesc</a></li>
          
            <li><a href="/notes/crte/adpersistence/">- AD Persistence</a></li>
          
            <li><a href="/notes/crte/cross/">- Cross attacks</a></li>
          
            <li><a href="/notes/crte/cheatsheet/">- Cheat Sheet</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">My CVEs</span>
        

        
        <ul>
          
            <li><a href="/cve/xss/">CVE-2024-2479</a></li>
          
            <li><a href="/cve/sqli/">CVE-2024-2480</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="3 - External Pentest Playbook">
    <meta itemprop="description" content="Testing the Security from an outside perspective.">
    <meta itemprop="datePublished" content="2023-11-26T00:00:00+06:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#preparation">Preparation</a></li>
  <li><a href="#attack-strategy">Attack strategy</a>
    <ul>
      <li><a href="#vulnerability-scanning">Vulnerability Scanning</a></li>
      <li><a href="#reviewing--extracting-information">Reviewing &amp; Extracting Information</a></li>
    </ul>
  </li>
  <li><a href="#information-gathering--osint">Information Gathering / OSINT</a>
    <ul>
      <li><a href="#hunting-breached-credentials">Hunting Breached Credentials</a></li>
      <li><a href="#identifying-employees-and-emails">Identifying Employees and Emails</a></li>
      <li><a href="#attacking-login-portals">Attacking Login Portals</a></li>
      <li><a href="#password-spraying-office365">Password Spraying Office365</a></li>
      <li><a href="#password-spraying-owa-outlook-web-app">Password Spraying OWA (outlook web app)</a></li>
      <li><a href="#attacking-other-portals">Attacking Other Portals</a></li>
      <li><a href="#bypassing-mfa-multi-factor-authentication">Bypassing MFA (multi factor authentication)</a></li>
    </ul>
  </li>
  <li><a href="#escalating-access----strategy">Escalating Access -  Strategy</a></li>
  <li><a href="#report-writing">Report Writing</a></li>
  <li><a href="#common-pentest-findings">Common Pentest Findings</a></li>
  <li><a href="#wrapping-up">Wrapping Up</a>
    <ul>
      <li><a href="#client-debriefs">Client Debriefs</a></li>
      <li><a href="#attestation-letters">Attestation Letters</a></li>
      <li><a href="#retesting">Retesting</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="nullified" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

<p>Goal:</p>

<p>Test the security from an outside perspective</p>

<p>Provide quality of service to the client</p>

<h1 id="preparation">Preparation</h1>

<p>Checklist:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Ensure ROE is signed by client
- Add IPs in scope to Scope tab
- Verify customer scope
- Send kickoff email
- Conduct vulnerability scanning with Nessus or other
- Identify emails/users/pass in breach databases (dehashed, breach-parse, etc)
- Identify employees &amp; email address format (linkedin, phonebook.cz, clearbit, etc)
- Identify client's websites and search for any data useful to help attack (job posting, system information, password policy, etc)
- Attempt to enumerate any accounts on portals, password reset function, etc
- Run web app scans, if necessary
- Conduct manual testing and exploitation on targets
- Validate scanning tool vulnerabilities
- Conduct password spraying guessing and brute force on login portals
- Escalate access from external to internal
- Validate previous year findings have been resolved
- Cleanup
</code></pre></div></div>

<p>ROE - Rules of engagement:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- This document summarizes the rules of engagement for the cybersecurity assessment offered by &lt;company&gt;. 
- The intent of this document is to clearly define the roles and responsabilities and the details of the test agreement.
- if ROE its not signed, do not start the pentest!
</code></pre></div></div>

<p>Verifying Scope:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- bgp.he.net
</code></pre></div></div>

<p>Client Communication:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- if you find a critical vulnerability, tell your client because they need to patch immediately.
</code></pre></div></div>

<h1 id="attack-strategy">Attack strategy</h1>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Think of external pentest like home security
- Low change of RCE, high chance of weak passwords
- OSINT is your best friend (and logical guessing)
</code></pre></div></div>

<h2 id="vulnerability-scanning">Vulnerability Scanning</h2>

<h3 id="nessus">Nessus</h3>

<p>Advanced Scan:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>General Settings
we can Schedule

Discovery: 
- host: default
- port: all ports 1-65535
- service: default

Assesment:
- enable web application if necessary
</code></pre></div></div>

<h2 id="reviewing--extracting-information">Reviewing &amp; Extracting Information</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Export the Nessus File
Generate a Report (Executive Summary &amp; Custom) to PDF and HTML
</code></pre></div></div>

<h3 id="optional">Optional</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>www.melcara.com
Nessus Parser:
- pearl parse_nessus_xml.v24.pl -f &lt;nessus file&gt;
</code></pre></div></div>

<h1 id="information-gathering--osint">Information Gathering / OSINT</h1>

<h2 id="hunting-breached-credentials">Hunting Breached Credentials</h2>

<p>Run breach-parser:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get emails and password that have been breached before
get the max information you can
later we can password spray or credential spray to try to get access to something using the emails found earlier
</code></pre></div></div>

<p>Run Dehashed or others tools:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gather more information
</code></pre></div></div>

<blockquote>
  <p>Do not attack out of scope domains</p>
</blockquote>

<blockquote>
  <p>but you can use the password breached from others domains and try to use in the scope domain</p>
</blockquote>

<blockquote>
  <p>same with emails breached, we can rockyou or something similar like summer2021 etc</p>
</blockquote>

<h2 id="identifying-employees-and-emails">Identifying Employees and Emails</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>clearbit - browser extension
hunter.io
phonebook.cz
-search for domains/emails
Linkedin &gt; employees
</code></pre></div></div>

<h3 id="enumerating-valid-accounts">Enumerating Valid Accounts</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>identify login portals - 'take note'
go to login portal of the domain scope 
try to reset an invalid login to show the error 
try to reset or login with emails that you gathered and see if the error changes
</code></pre></div></div>

<h3 id="others-useful-information">Others useful information</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Look at job posting, system information, password policy
</code></pre></div></div>

<h2 id="attacking-login-portals">Attacking Login Portals</h2>

<p>By this point, you should have identified:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Login portals to attack
- List of possible employees/emails
- Password strategies to employ
</code></pre></div></div>

<h3 id="password-strategy">Password strategy</h3>
<p>Could be:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- season + year + special character
- past season + year + special character
- month + year 
- company name + number/year/something
- city or address location
- sports team of the city 
</code></pre></div></div>

<h2 id="password-spraying-office365">Password Spraying Office365</h2>

<p>Majority of clients uses microsoft, because AD</p>

<h3 id="one-spray-pass-tool-example">One spray pass Tool example</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">trevorspray</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">e</span> <span class="o">&lt;</span><span class="nb">list</span> <span class="n">of</span> <span class="n">emails</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">passwords</span> <span class="sh">'</span><span class="s">winter20!</span><span class="sh">'</span> <span class="o">--</span><span class="n">delay</span> <span class="mi">10</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">current</span><span class="o">-</span><span class="n">ip</span> <span class="o">--</span><span class="n">ssh</span> <span class="n">user</span><span class="nd">@ip</span> <span class="o">-</span><span class="n">k</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="p">.</span><span class="nf">pem </span><span class="p">(</span><span class="n">aws</span> <span class="n">key</span> <span class="n">pair</span><span class="p">)</span>

<span class="c1"># delay = time to try again
# no-current-ip = not set our ip 
# a couple of user@ip because will spray one at time
# if the delay is 10sec and you have 10 accounts, after 100secs the spray will come back to the first, so its a good practice to not block the account.
</span></code></pre></div></div>

<ul>
  <li>Be aware of the lock out password policy</li>
  <li>If you get lock account error, stop the spraying</li>
  <li>If the lock out policy is lets say 5 tries, try 4 times then try another 4 an hour later</li>
</ul>

<p>Sign in for AWS</p>

<p>Go to aws management console:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ec2 &gt; launch VM
ubuntu &gt; free tier eligible
launch instances
grab the public IP
and put in the script user@ip after spraying in the ip of the target
</code></pre></div></div>

<h2 id="password-spraying-owa-outlook-web-app">Password Spraying OWA (outlook web app)</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>metasploit &gt; search owa
use auxiliary/scanner/http/owa_login
set options
</code></pre></div></div>

<h2 id="attacking-other-portals">Attacking Other Portals</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- With other type of portals we go to Burp
- set scope &gt; options AND target scope 
- intercept the request
- send to intruder/repeater
- intruder &gt; options &gt; grep - match &gt; add the login error
- in options &gt; set the password as variable
- sniper attack &gt; payloads &gt; add some common passwords (winter2021!, summer2021@ etc)
- look at the length/status code/the grep match of the login error
</code></pre></div></div>

<p>If you wanna try credential stuffing:</p>

<blockquote>
  <p>this will try the first username with the first password, the second with the second etc</p>
</blockquote>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- set the username to variable as well
- set the attack type to pitchfork
- in payloads &gt; list &gt; add logins/usernames/login too
</code></pre></div></div>

<p>We can use the attack type cluster bomb:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This will try every username with every password
- the pitchfork option is better to not lock out the account
</code></pre></div></div>

<h2 id="bypassing-mfa-multi-factor-authentication">Bypassing MFA (multi factor authentication)</h2>

<p>MFASweep:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-MFASweep -Username &lt;user&gt; -Password &lt;pass&gt;
</code></pre></div></div>

<p>For example:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- We could ask the client, to create an account For us.
- and then we try to log in only with the password, without the MFA.
- If the company set the MFA correctly, this should not work.

Invoke-SelfSearch -Mailbox &lt;email&gt; -ExchHostname &lt;hostname&gt; -remote
</code></pre></div></div>

<blockquote>
  <p>Usually social engineering is out of scope, so this method is useful to test their MFA</p>
</blockquote>

<h1 id="escalating-access----strategy">Escalating Access -  Strategy</h1>

<p>Here we have some sort of access and want to escalate</p>

<p>Look at azure portal, share point, vpns access, emails</p>

<ul>
  <li>Enumeration is they key</li>
</ul>

<h1 id="report-writing">Report Writing</h1>

<p>Examples:</p>

<p>https://github.com/hmaverickadams/TCM-Security-Sample-Pentest-Report</p>

<p>https://tcm-sec.com/wp-content/uploads/2021/10/TCMS-Demo-Corp-Security-Assessment-Findings-Report.pdf</p>

<blockquote>
  <p>If its a web pentest we should put : OWASP references
If its a external: NIST reference</p>
</blockquote>

<h1 id="common-pentest-findings">Common Pentest Findings</h1>

<p><strong>Insufficient Authentication Controls</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- client do not have MFA
- in case you didn't find the MFA, you can ask the client
- therefore you can recommend in the report anyways
</code></pre></div></div>

<p><strong>Weak Password Policy</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- client need to understand that they need to improve de pass policy
- again,  if you didn't find the pass policy, just ask the client
- so you can help them improve that
</code></pre></div></div>

<p><strong>Insufficient Patching</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Provide the mitigation with there is no patch available for that vulnerability
- even if you didnt explore in time, add in the report cause they need to mitigate
- check the versions of services to find these kind of patching issues
- nessus is great for that also
</code></pre></div></div>

<p><strong>Default Credentials</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Check default credentials of every service: emails, printers, web servers, router, etc
</code></pre></div></div>

<p><strong>Insufficient Encryption</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>client uses HTTP: they should migrate to HTTPS and turnoff http
web issues: SSL, TLS, SWEET32, RC4, Self-Signed Certificate
mitigation: disable weak ciphers on public web services
</code></pre></div></div>

<p><strong>Information Disclosure</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>information leaked through errors
mitigation: disable debug reporting / properly handle invalid users
unnecessary information via mDNS on UDP port 5353
mitigation: filter incoming traffic to UDP port 5353
unnecessary information within http responde headers
mitigation: remove unnecessary information from http headers
verbose error messages 403 &amp; 404
mitigation: disable verbose error message in the server config
</code></pre></div></div>

<p><strong>Username Enumeration</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Forgot password errors: synchronize valid/invalid account messages
</code></pre></div></div>

<p><strong>Default Web Pages</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apache, IIS, etc - the attacker will inventory the software version for future attacks
mitigation: replace the default pages with terms of service.
</code></pre></div></div>

<p><strong>Open Mail Relays</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://www.blackhillsinfosec.com/how-to-test-for-open-mail-relays/
</code></pre></div></div>

<p><strong>IKE Aggressive Mode</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>in aggressive mode enable we could capture the PSK (pre-shared key) of a VPN
tool: ike-scan
mitigation: synchronize error messages. error messages should be consistent with valid and invalid users
the likelyhood of exploiting this is very low, close to zero. but is a common finding and potential risk.
</code></pre></div></div>

<p><strong>Unexpected Perimeter Services</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rdp, telnet enable to the external network
talk to the client, if thats is intentional 
</code></pre></div></div>

<p><strong>Insufficient Traffic Blocking</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tool: Shotsherpa
block unnecessary traffics like others countries, if possible
perhaps not blocking, but limiting traffic in certain way
</code></pre></div></div>

<p><strong>Undetected Malicious Activity</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap scan, nessus scan, web enumeration brute force 
make sure the client knows where they need to improve
</code></pre></div></div>

<p><strong>Historical Account Compromises</strong>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accounts that have been breached before

Remediation:
- Avoid password reuse between sites.
- Train users to not use work emails for site registrations unless necessary.
- enforcing password rotation with strict password complexity requirements.
- its recommended ‘haveibeenpwned.com’ subscription for proactive alerting of compromised comporate accounts.
</code></pre></div></div>

<h1 id="wrapping-up">Wrapping Up</h1>

<h2 id="client-debriefs">Client Debriefs</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Explain the report
Keep simple like you are explain to a non technical people
Its normal not know something or question they ask
Our job is to help find securities vulnerabilities before the attacker and help the company to solve those issues and improve their network
	
- You need to be technical, explain things at high level
- Able to write well
- Sociable enough to debrief a report in front of people
</code></pre></div></div>

<h2 id="attestation-letters">Attestation Letters</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>After the pentest in finished, we send a letter to summarizes the activities performed
</code></pre></div></div>

<h2 id="retesting">Retesting</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>We can offer the company 60~90 days of retesting, that means they have some time to fix the problems we found. 
Then we go there and retest the vulnerabilities
We do not take off the vulnerabilties found in the last pentest, we just add remetiate if the company fixed the issue.
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#begginer" class="page__taxonomy-item" rel="tag">begginer</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#external" class="page__taxonomy-item" rel="tag">external</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#pentest" class="page__taxonomy-item" rel="tag">pentest</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#notes" class="page__taxonomy-item" rel="tag">notes</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#pnpt" class="page__taxonomy-item" rel="tag">pnpt</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2023-11-26T00:00:00+06:00">November 26, 2023</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=3+-+External+Pentest+Playbook%20http%3A%2F%2Flocalhost%3A4000%2Fnotes%2Fpnpt%2Fpentestexternal%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fnotes%2Fpnpt%2Fpentestexternal%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fnotes%2Fpnpt%2Fpentestexternal%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/notes/pnpt/osint/" class="pagination--pager" title="2 - Open-Source Intelligence (OSINT)
">Previous</a>
    
    
      <a href="/notes/pnpt/linuxprivesc/" class="pagination--pager" title="4 - Linux Privilege Escalation
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">

    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>





  
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  
    <script src="/assets/js/clipboard.js"></script>
  



  </body>
</html>
